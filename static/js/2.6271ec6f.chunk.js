(this.webpackJsonpgenerative=this.webpackJsonpgenerative||[]).push([[2],{493:function(te,z,d){"use strict";d.d(z,"a",function(){return C});var R=d(436),M=d(446),O=d(485),T=d(692),B=d(447);O.a.CreateLineSystem=function(v){for(var n=[],o=[],_=v.lines,l=v.colors,f=[],a=0,r=0;r<_.length;r++)for(var e=_[r],t=0;t<e.length;t++){if(o.push(e[t].x,e[t].y,e[t].z),l){var i=l[r];f.push(i[t].r,i[t].g,i[t].b,i[t].a)}t>0&&(n.push(a-1),n.push(a)),a++}var u=new O.a;return u.indices=n,u.positions=o,l&&(u.colors=f),u},O.a.CreateDashedLines=function(v){var n=v.dashSize||3,o=v.gapSize||1,_=v.dashNb||200,l=v.points,f=new Array,a=new Array,r=R.e.Zero(),e=0,t=0,i=0,u=0,c=0,g=0,h=0;for(h=0;h<l.length-1;h++)l[h+1].subtractToRef(l[h],r),e+=r.length();for(i=e/_,u=n*i/(n+o),h=0;h<l.length-1;h++){l[h+1].subtractToRef(l[h],r),t=Math.floor(r.length()/i),r.normalize();for(var E=0;E<t;E++)c=i*E,f.push(l[h].x+c*r.x,l[h].y+c*r.y,l[h].z+c*r.z),f.push(l[h].x+(c+u)*r.x,l[h].y+(c+u)*r.y,l[h].z+(c+u)*r.z),a.push(g,g+1),g+=2}var y=new O.a;return y.positions=f,y.indices=a,y},M.a.CreateLines=function(v,n,o,_,l){o===void 0&&(o=null),_===void 0&&(_=!1),l===void 0&&(l=null);var f={points:n,updatable:_,instance:l};return C.CreateLines(v,f,o)},M.a.CreateDashedLines=function(v,n,o,_,l,f,a,r){f===void 0&&(f=null);var e={points:n,dashSize:o,gapSize:_,dashNb:l,updatable:a,instance:r};return C.CreateDashedLines(v,e,f)};var C=function(){function v(){}return v.CreateLineSystem=function(n,o,_){var l=o.instance,f=o.lines,a=o.colors;if(l){var r=l.getVerticesData(B.b.PositionKind),e,t;a&&(e=l.getVerticesData(B.b.ColorKind));for(var i=0,u=0,c=0;c<f.length;c++)for(var g=f[c],h=0;h<g.length;h++)r[i]=g[h].x,r[i+1]=g[h].y,r[i+2]=g[h].z,a&&e&&(t=a[c],e[u]=t[h].r,e[u+1]=t[h].g,e[u+2]=t[h].b,e[u+3]=t[h].a,u+=4),i+=3;return l.updateVerticesData(B.b.PositionKind,r,!1,!1),a&&e&&l.updateVerticesData(B.b.ColorKind,e,!1,!1),l}var E=!!a,y=new T.b(n,_,null,void 0,void 0,E,o.useVertexAlpha),S=O.a.CreateLineSystem(o);return S.applyToMesh(y,o.updatable),y},v.CreateLines=function(n,o,_){_===void 0&&(_=null);var l=o.colors?[o.colors]:null,f=v.CreateLineSystem(n,{lines:[o.points],updatable:o.updatable,instance:o.instance,colors:l,useVertexAlpha:o.useVertexAlpha},_);return f},v.CreateDashedLines=function(n,o,_){_===void 0&&(_=null);var l=o.points,f=o.instance,a=o.gapSize||1,r=o.dashSize||3;if(f){var e=function(u){var c=R.e.Zero(),g=u.length/6,h=0,E=0,y=0,S=0,m=0,P=0,D=0,s=0;for(D=0;D<l.length-1;D++)l[D+1].subtractToRef(l[D],c),h+=c.length();y=h/g;var I=f._creationDataStorage.dashSize,p=f._creationDataStorage.gapSize;for(S=I*y/(I+p),D=0;D<l.length-1;D++)for(l[D+1].subtractToRef(l[D],c),E=Math.floor(c.length()/y),c.normalize(),s=0;s<E&&P<u.length;)m=y*s,u[P]=l[D].x+m*c.x,u[P+1]=l[D].y+m*c.y,u[P+2]=l[D].z+m*c.z,u[P+3]=l[D].x+(m+S)*c.x,u[P+4]=l[D].y+(m+S)*c.y,u[P+5]=l[D].z+(m+S)*c.z,P+=6,s++;for(;P<u.length;)u[P]=l[D].x,u[P+1]=l[D].y,u[P+2]=l[D].z,P+=3};return f.updateMeshPositions(e,!1),f}var t=new T.b(n,_,null,void 0,void 0,void 0,o.useVertexAlpha),i=O.a.CreateDashedLines(o);return i.applyToMesh(t,o.updatable),t._creationDataStorage=new M.b,t._creationDataStorage.dashSize=r,t._creationDataStorage.gapSize=a,t},v}()},501:function(te,z,d){"use strict";var R=d(435),M="instancesDeclaration",O=`#ifdef INSTANCES
attribute vec4 world0;
attribute vec4 world1;
attribute vec4 world2;
attribute vec4 world3;
#ifdef THIN_INSTANCES
uniform mat4 world;
#endif
#else
uniform mat4 world;
#endif`;R.a.IncludesShadersStore[M]=O;var T={name:M,shader:O}},617:function(te,z,d){"use strict";d.d(z,"a",function(){return B});var R=d(436),M=d(446),O=d(706),T=d(756);M.a.ExtrudeShape=function(C,v,n,o,_,l,f,a,r,e){f===void 0&&(f=null);var t={shape:v,path:n,scale:o,rotation:_,cap:l===0?0:l||M.a.NO_CAP,sideOrientation:r,instance:e,updatable:a};return B.ExtrudeShape(C,t,f)},M.a.ExtrudeShapeCustom=function(C,v,n,o,_,l,f,a,r,e,t,i){var u={shape:v,path:n,scaleFunction:o,rotationFunction:_,ribbonCloseArray:l,ribbonClosePath:f,cap:a===0?0:a||M.a.NO_CAP,sideOrientation:t,instance:i,updatable:e};return B.ExtrudeShapeCustom(C,u,r)};var B=function(){function C(){}return C.ExtrudeShape=function(v,n,o){o===void 0&&(o=null);var _=n.path,l=n.shape,f=n.scale||1,a=n.rotation||0,r=n.cap===0?0:n.cap||M.a.NO_CAP,e=n.updatable,t=M.a._GetDefaultSideOrientation(n.sideOrientation),i=n.instance||null,u=n.invertUV||!1;return C._ExtrudeShapeGeneric(v,l,_,f,a,null,null,!1,!1,r,!1,o,!!e,t,i,u,n.frontUVs||null,n.backUVs||null)},C.ExtrudeShapeCustom=function(v,n,o){o===void 0&&(o=null);var _=n.path,l=n.shape,f=n.scaleFunction||function(){return 1},a=n.rotationFunction||function(){return 0},r=n.ribbonCloseArray||!1,e=n.ribbonClosePath||!1,t=n.cap===0?0:n.cap||M.a.NO_CAP,i=n.updatable,u=M.a._GetDefaultSideOrientation(n.sideOrientation),c=n.instance,g=n.invertUV||!1;return C._ExtrudeShapeGeneric(v,l,_,null,null,f,a,r,e,t,!0,o,!!i,u,c||null,g,n.frontUVs||null,n.backUVs||null)},C._ExtrudeShapeGeneric=function(v,n,o,_,l,f,a,r,e,t,i,u,c,g,h,E,y,S){var m=function(U,Z,K,A,V,N,W,L,J,H){for(var j=K.getTangents(),F=K.getNormals(),k=K.getBinormals(),Y=K.getDistances(),b=0,ee=function(){return V!==null?V:1},re=function(){return N!==null?N:0},se=H&&L?L:re,ae=H&&W?W:ee,G=J===M.a.NO_CAP||J===M.a.CAP_END?0:2,w=R.c.Matrix[0],x=0;x<Z.length;x++){for(var X=new Array,Q=se(x,Y[x]),q=ae(x,Y[x]),$=0;$<U.length;$++){R.a.RotationAxisToRef(j[x],b,w);var ue=j[x].scale(U[$].z).add(F[x].scale(U[$].x)).add(k[x].scale(U[$].y)),ie=X[$]?X[$]:R.e.Zero();R.e.TransformCoordinatesToRef(ue,w,ie),ie.scaleInPlace(q).addInPlace(Z[x]),X[$]=ie}A[G]=X,b+=Q,G++}var oe=function(le){var ce=Array(),fe=R.e.Zero(),ne;for(ne=0;ne<le.length;ne++)fe.addInPlace(le[ne]);for(fe.scaleInPlace(1/le.length),ne=0;ne<le.length;ne++)ce.push(fe);return ce};switch(J){case M.a.NO_CAP:break;case M.a.CAP_START:A[0]=oe(A[2]),A[1]=A[2];break;case M.a.CAP_END:A[G]=A[G-1],A[G+1]=oe(A[G-1]);break;case M.a.CAP_ALL:A[0]=oe(A[2]),A[1]=A[2],A[G]=A[G-1],A[G+1]=oe(A[G-1]);break;default:break}return A},P,D;if(h){var s=h._creationDataStorage;return P=s.path3D.update(o),D=m(n,o,s.path3D,s.pathArray,_,l,f,a,s.cap,i),h=M.a.CreateRibbon("",D,!1,!1,0,u||void 0,!1,0,h),h}P=new T.g(o);var I=new Array;t=t<0||t>3?0:t,D=m(n,o,P,I,_,l,f,a,t,i);var p=O.a.CreateRibbon(v,{pathArray:D,closeArray:r,closePath:e,updatable:c,sideOrientation:g,invertUV:E,frontUVs:y||void 0,backUVs:S||void 0},u);return p._creationDataStorage.pathArray=D,p._creationDataStorage.path3D=P,p._creationDataStorage.cap=t,p},C}()},692:function(te,z,d){"use strict";d.d(z,"b",function(){return l}),d.d(z,"a",function(){return f});var R=d(434),M=d(441),O=d(447),T=d(446),B=d(731),C=d(459),v=d(509),n=d(454),o=d(732),_=d(733);T.a._LinesMeshParser=function(a,r){return l.Parse(a,r)};var l=function(a){Object(R.d)(r,a);function r(e,t,i,u,c,g,h){t===void 0&&(t=null),i===void 0&&(i=null),u===void 0&&(u=null);var E=a.call(this,e,t,i,u,c)||this;E.useVertexColor=g,E.useVertexAlpha=h,E.color=new M.a(1,1,1),E.alpha=1,u&&(E.color=u.color.clone(),E.alpha=u.alpha,E.useVertexColor=u.useVertexColor,E.useVertexAlpha=u.useVertexAlpha),E.intersectionThreshold=.1;var y=[],S={attributes:[O.b.PositionKind],uniforms:["vClipPlane","vClipPlane2","vClipPlane3","vClipPlane4","vClipPlane5","vClipPlane6","world","viewProjection"],needAlphaBlending:!0,defines:y};return h===!1&&(S.needAlphaBlending=!1),g?(S.defines.push("#define VERTEXCOLOR"),S.attributes.push(O.b.ColorKind)):(S.uniforms.push("color"),E.color4=new M.b),E._colorShader=new v.a("colorShader",E.getScene(),"color",S),E}return r.prototype._addClipPlaneDefine=function(e){var t="#define "+e,i=this._colorShader.options.defines.indexOf(t);i===-1&&this._colorShader.options.defines.push(t)},r.prototype._removeClipPlaneDefine=function(e){var t="#define "+e,i=this._colorShader.options.defines.indexOf(t);i!==-1&&this._colorShader.options.defines.splice(i,1)},r.prototype.isReady=function(){var e=this.getScene();return e.clipPlane?this._addClipPlaneDefine("CLIPPLANE"):this._removeClipPlaneDefine("CLIPPLANE"),e.clipPlane2?this._addClipPlaneDefine("CLIPPLANE2"):this._removeClipPlaneDefine("CLIPPLANE2"),e.clipPlane3?this._addClipPlaneDefine("CLIPPLANE3"):this._removeClipPlaneDefine("CLIPPLANE3"),e.clipPlane4?this._addClipPlaneDefine("CLIPPLANE4"):this._removeClipPlaneDefine("CLIPPLANE4"),e.clipPlane5?this._addClipPlaneDefine("CLIPPLANE5"):this._removeClipPlaneDefine("CLIPPLANE5"),e.clipPlane6?this._addClipPlaneDefine("CLIPPLANE6"):this._removeClipPlaneDefine("CLIPPLANE6"),this._colorShader.isReady(this)?a.prototype.isReady.call(this):!1},r.prototype.getClassName=function(){return"LinesMesh"},Object.defineProperty(r.prototype,"material",{get:function(){return this._colorShader},set:function(e){},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"checkCollisions",{get:function(){return!1},set:function(e){},enumerable:!1,configurable:!0}),r.prototype._bind=function(e,t,i){if(!this._geometry)return this;var u=this._colorShader.getEffect(),c=this.isUnIndexed?null:this._geometry.getIndexBuffer();if(this._geometry._bind(u,c),!this.useVertexColor){var g=this.color,h=g.r,E=g.g,y=g.b;this.color4.set(h,E,y,this.alpha),this._colorShader.setColor4("color",this.color4)}return n.a.BindClipPlane(u,this.getScene()),this},r.prototype._draw=function(e,t,i){if(!this._geometry||!this._geometry.getVertexBuffers()||!this._unIndexed&&!this._geometry.getIndexBuffer())return this;var u=this.getScene().getEngine();return this._unIndexed?u.drawArraysType(C.a.LineListDrawMode,e.verticesStart,e.verticesCount,i):u.drawElementsType(C.a.LineListDrawMode,e.indexStart,e.indexCount,i),this},r.prototype.dispose=function(e){this._colorShader.dispose(!1,!1,!0),a.prototype.dispose.call(this,e)},r.prototype.clone=function(e,t,i){return t===void 0&&(t=null),new r(e,this.getScene(),t,this,i)},r.prototype.createInstance=function(e){return new f(e,this)},r.prototype.serialize=function(e){a.prototype.serialize.call(this,e),e.color=this.color.asArray(),e.alpha=this.alpha},r.Parse=function(e,t){var i=new r(e.name,t);return i.color=M.a.FromArray(e.color),i.alpha=e.alpha,i},r}(T.a),f=function(a){Object(R.d)(r,a);function r(e,t){var i=a.call(this,e,t)||this;return i.intersectionThreshold=t.intersectionThreshold,i}return r.prototype.getClassName=function(){return"InstancedLinesMesh"},r}(B.a)},706:function(te,z,d){"use strict";d.d(z,"a",function(){return C});var R=d(436),M=d(446),O=d(447),T=d(485),B=d(536);T.a.CreateRibbon=function(v){var n=v.pathArray,o=v.closeArray||!1,_=v.closePath||!1,l=v.invertUV||!1,f=Math.floor(n[0].length/2),a=v.offset||f;a=a>f?f:Math.floor(a);var r=v.sideOrientation===0?0:v.sideOrientation||T.a.DEFAULTSIDE,e=v.uvs,t=v.colors,i=[],u=[],c=[],g=[],h=[],E=[],y=[],S=[],m,P=[],D=[],s,I,p;if(n.length<2){var U=[],Z=[];for(I=0;I<n[0].length-a;I++)U.push(n[0][I]),Z.push(n[0][I+a]);n=[U,Z]}var K=0,A=_?1:0,V,N;m=n[0].length;var W,L;for(s=0;s<n.length;s++){for(y[s]=0,h[s]=[0],V=n[s],N=V.length,m=m<N?m:N,p=0;p<N;)i.push(V[p].x,V[p].y,V[p].z),p>0&&(W=V[p].subtract(V[p-1]).length(),L=W+y[s],h[s].push(L),y[s]=L),p++;_&&(p--,i.push(V[0].x,V[0].y,V[0].z),W=V[p].subtract(V[0]).length(),L=W+y[s],h[s].push(L),y[s]=L),P[s]=N+A,D[s]=K,K+=N+A}var J,H,j=null,F=null;for(I=0;I<m+A;I++){for(S[I]=0,E[I]=[0],s=0;s<n.length-1;s++)J=n[s],H=n[s+1],I===m?(j=J[0],F=H[0]):(j=J[I],F=H[I]),W=F.subtract(j).length(),L=W+S[I],E[I].push(L),S[I]=L;o&&F&&j&&(J=n[s],H=n[0],I===m&&(F=H[0]),W=F.subtract(j).length(),L=W+S[I],S[I]=L)}var k,Y;if(e)for(s=0;s<e.length;s++)g.push(e[s].x,e[s].y);else for(s=0;s<n.length;s++)for(I=0;I<m+A;I++)k=y[s]!=0?h[s][I]/y[s]:0,Y=S[I]!=0?E[I][s]/S[I]:0,l?g.push(Y,k):g.push(k,Y);s=0;for(var b=0,ee=P[s]-1,re=P[s+1]-1,se=ee<re?ee:re,ae=D[1]-D[0],G=o?P.length:P.length-1;b<=se&&s<G;)u.push(b,b+ae,b+1),u.push(b+ae+1,b+1,b+ae),b+=1,b===se&&(s++,s===P.length-1?(ae=D[0]-D[s],ee=P[s]-1,re=P[0]-1):(ae=D[s+1]-D[s],ee=P[s]-1,re=P[s+1]-1),b=D[s],se=ee<re?ee+b:re+b);if(T.a.ComputeNormals(i,u,c),_){var w=0,x=0;for(s=0;s<n.length;s++)w=D[s]*3,s+1<n.length?x=(D[s+1]-1)*3:x=c.length-3,c[w]=(c[w]+c[x])*.5,c[w+1]=(c[w+1]+c[x+1])*.5,c[w+2]=(c[w+2]+c[x+2])*.5,c[x]=c[w],c[x+1]=c[w+1],c[x+2]=c[w+2]}T.a._ComputeSides(r,i,u,c,g,v.frontUVs,v.backUVs);var X=null;if(t){X=new Float32Array(t.length*4);for(var Q=0;Q<t.length;Q++)X[Q*4]=t[Q].r,X[Q*4+1]=t[Q].g,X[Q*4+2]=t[Q].b,X[Q*4+3]=t[Q].a}var q=new T.a,$=new Float32Array(i),ue=new Float32Array(c),ie=new Float32Array(g);return q.indices=u,q.positions=$,q.normals=ue,q.uvs=ie,X&&q.set(X,O.b.ColorKind),_&&(q._idx=D),q},M.a.CreateRibbon=function(v,n,o,_,l,f,a,r,e){return o===void 0&&(o=!1),a===void 0&&(a=!1),C.CreateRibbon(v,{pathArray:n,closeArray:o,closePath:_,offset:l,updatable:a,sideOrientation:r,instance:e},f)};var C=function(){function v(){}return v.CreateRibbon=function(n,o,_){_===void 0&&(_=null);var l=o.pathArray,f=o.closeArray,a=o.closePath,r=M.a._GetDefaultSideOrientation(o.sideOrientation),e=o.instance,t=o.updatable;if(e){var i=R.c.Vector3[0].setAll(Number.MAX_VALUE),u=R.c.Vector3[1].setAll(-Number.MAX_VALUE),c=function(V){for(var N=l[0].length,W=e,L=0,J=W._originalBuilderSideOrientation===M.a.DOUBLESIDE?2:1,H=1;H<=J;++H)for(var j=0;j<l.length;++j){var F=l[j],k=F.length;N=N<k?N:k;for(var Y=0;Y<N;++Y){var b=F[Y];V[L]=b.x,V[L+1]=b.y,V[L+2]=b.z,i.minimizeInPlaceFromFloats(b.x,b.y,b.z),u.maximizeInPlaceFromFloats(b.x,b.y,b.z),L+=3}if(W._creationDataStorage&&W._creationDataStorage.closePath){var b=F[0];V[L]=b.x,V[L+1]=b.y,V[L+2]=b.z,L+=3}}},g=e.getVerticesData(O.b.PositionKind);if(c(g),e._boundingInfo?e._boundingInfo.reConstruct(i,u,e._worldMatrix):e._boundingInfo=new B.a(i,u,e._worldMatrix),e.updateVerticesData(O.b.PositionKind,g,!1,!1),o.colors){for(var h=e.getVerticesData(O.b.ColorKind),E=0,y=0;E<o.colors.length;E++,y+=4){var S=o.colors[E];h[y]=S.r,h[y+1]=S.g,h[y+2]=S.b,h[y+3]=S.a}e.updateVerticesData(O.b.ColorKind,h,!1,!1)}if(o.uvs){for(var m=e.getVerticesData(O.b.UVKind),P=0;P<o.uvs.length;P++)m[P*2]=o.uvs[P].x,m[P*2+1]=o.uvs[P].y;e.updateVerticesData(O.b.UVKind,m,!1,!1)}if(!e.areNormalsFrozen||e.isFacetDataEnabled){var D=e.getIndices(),s=e.getVerticesData(O.b.NormalKind),I=e.isFacetDataEnabled?e.getFacetDataParameters():null;if(T.a.ComputeNormals(g,D,s,I),e._creationDataStorage&&e._creationDataStorage.closePath)for(var p=0,U=0,Z=0;Z<l.length;Z++)p=e._creationDataStorage.idx[Z]*3,Z+1<l.length?U=(e._creationDataStorage.idx[Z+1]-1)*3:U=s.length-3,s[p]=(s[p]+s[U])*.5,s[p+1]=(s[p+1]+s[U+1])*.5,s[p+2]=(s[p+2]+s[U+2])*.5,s[U]=s[p],s[U+1]=s[p+1],s[U+2]=s[p+2];e.areNormalsFrozen||e.updateVerticesData(O.b.NormalKind,s,!1,!1)}return e}else{var K=new M.a(n,_);K._originalBuilderSideOrientation=r,K._creationDataStorage=new M.b;var A=T.a.CreateRibbon(o);return a&&(K._creationDataStorage.idx=A._idx),K._creationDataStorage.closePath=a,K._creationDataStorage.closeArray=f,A.applyToMesh(K,t),K}},v}()},731:function(te,z,d){"use strict";d.d(z,"a",function(){return l});var R=d(434),M=d(436),O=d(440),T=d(462),B=d(446),C=d(474),v=d(499),n=d(447),o=d(536),_=d(443);B.a._instancedMeshFactory=function(f,a){var r=new l(f,a);if(a.instancedBuffers){r.instancedBuffers={};for(var e in a.instancedBuffers)r.instancedBuffers[e]=a.instancedBuffers[e]}return r};var l=function(f){Object(R.d)(a,f);function a(r,e){var t=f.call(this,r,e.getScene())||this;t._indexInSourceMeshInstanceArray=-1,e.addInstance(t),t._sourceMesh=e,t._unIndexed=e._unIndexed,t.position.copyFrom(e.position),t.rotation.copyFrom(e.rotation),t.scaling.copyFrom(e.scaling),e.rotationQuaternion&&(t.rotationQuaternion=e.rotationQuaternion.clone()),t.animations=_.b.Slice(e.animations);for(var i=0,u=e.getAnimationRanges();i<u.length;i++){var c=u[i];c!=null&&t.createAnimationRange(c.name,c.from,c.to)}return t.infiniteDistance=e.infiniteDistance,t.setPivotMatrix(e.getPivotMatrix()),t.refreshBoundingInfo(),t._syncSubMeshes(),t}return a.prototype.getClassName=function(){return"InstancedMesh"},Object.defineProperty(a.prototype,"lightSources",{get:function(){return this._sourceMesh._lightSources},enumerable:!1,configurable:!0}),a.prototype._resyncLightSources=function(){},a.prototype._resyncLightSource=function(r){},a.prototype._removeLightSource=function(r,e){},Object.defineProperty(a.prototype,"receiveShadows",{get:function(){return this._sourceMesh.receiveShadows},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"material",{get:function(){return this._sourceMesh.material},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"visibility",{get:function(){return this._sourceMesh.visibility},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"skeleton",{get:function(){return this._sourceMesh.skeleton},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"renderingGroupId",{get:function(){return this._sourceMesh.renderingGroupId},set:function(r){!this._sourceMesh||r===this._sourceMesh.renderingGroupId||O.a.Warn("Note - setting renderingGroupId of an instanced mesh has no effect on the scene")},enumerable:!1,configurable:!0}),a.prototype.getTotalVertices=function(){return this._sourceMesh?this._sourceMesh.getTotalVertices():0},a.prototype.getTotalIndices=function(){return this._sourceMesh.getTotalIndices()},Object.defineProperty(a.prototype,"sourceMesh",{get:function(){return this._sourceMesh},enumerable:!1,configurable:!0}),a.prototype.createInstance=function(r){return this._sourceMesh.createInstance(r)},a.prototype.isReady=function(r){return r===void 0&&(r=!1),this._sourceMesh.isReady(r,!0)},a.prototype.getVerticesData=function(r,e){return this._sourceMesh.getVerticesData(r,e)},a.prototype.setVerticesData=function(r,e,t,i){return this.sourceMesh&&this.sourceMesh.setVerticesData(r,e,t,i),this.sourceMesh},a.prototype.updateVerticesData=function(r,e,t,i){return this.sourceMesh&&this.sourceMesh.updateVerticesData(r,e,t,i),this.sourceMesh},a.prototype.setIndices=function(r,e){return e===void 0&&(e=null),this.sourceMesh&&this.sourceMesh.setIndices(r,e),this.sourceMesh},a.prototype.isVerticesDataPresent=function(r){return this._sourceMesh.isVerticesDataPresent(r)},a.prototype.getIndices=function(){return this._sourceMesh.getIndices()},Object.defineProperty(a.prototype,"_positions",{get:function(){return this._sourceMesh._positions},enumerable:!1,configurable:!0}),a.prototype.refreshBoundingInfo=function(r){if(r===void 0&&(r=!1),this._boundingInfo&&this._boundingInfo.isLocked)return this;var e=this._sourceMesh.geometry?this._sourceMesh.geometry.boundingBias:null;return this._refreshBoundingInfo(this._sourceMesh._getPositionData(r),e),this},a.prototype._preActivate=function(){return this._currentLOD&&this._currentLOD._preActivate(),this},a.prototype._activate=function(r,e){if(this._sourceMesh.subMeshes||O.a.Warn("Instances should only be created for meshes with geometry."),this._currentLOD){var t=this._currentLOD._getWorldMatrixDeterminant()>0!=this._getWorldMatrixDeterminant()>0;if(t)return this._internalAbstractMeshDataInfo._actAsRegularMesh=!0,!0;if(this._internalAbstractMeshDataInfo._actAsRegularMesh=!1,this._currentLOD._registerInstanceForRenderId(this,r),e){if(!this._currentLOD._internalAbstractMeshDataInfo._isActiveIntermediate)return this._currentLOD._internalAbstractMeshDataInfo._onlyForInstancesIntermediate=!0,!0}else if(!this._currentLOD._internalAbstractMeshDataInfo._isActive)return this._currentLOD._internalAbstractMeshDataInfo._onlyForInstances=!0,!0}return!1},a.prototype._postActivate=function(){this._sourceMesh.edgesShareWithInstances&&this._sourceMesh._edgesRenderer&&this._sourceMesh._edgesRenderer.isEnabled&&this._sourceMesh._renderingGroup?(this._sourceMesh._renderingGroup._edgesRenderers.pushNoDuplicate(this._sourceMesh._edgesRenderer),this._sourceMesh._edgesRenderer.customInstances.push(this.getWorldMatrix())):this._edgesRenderer&&this._edgesRenderer.isEnabled&&this._sourceMesh._renderingGroup&&this._sourceMesh._renderingGroup._edgesRenderers.push(this._edgesRenderer)},a.prototype.getWorldMatrix=function(){if(this._currentLOD&&this._currentLOD.billboardMode!==v.a.BILLBOARDMODE_NONE&&this._currentLOD._masterMesh!==this){var r=this._currentLOD._masterMesh;return this._currentLOD._masterMesh=this,M.c.Vector3[7].copyFrom(this._currentLOD.position),this._currentLOD.position.set(0,0,0),M.c.Matrix[0].copyFrom(this._currentLOD.computeWorldMatrix(!0)),this._currentLOD.position.copyFrom(M.c.Vector3[7]),this._currentLOD._masterMesh=r,M.c.Matrix[0]}return f.prototype.getWorldMatrix.call(this)},Object.defineProperty(a.prototype,"isAnInstance",{get:function(){return!0},enumerable:!1,configurable:!0}),a.prototype.getLOD=function(r){if(!r)return this;var e=this.getBoundingInfo();return this._currentLOD=this.sourceMesh.getLOD(r,e.boundingSphere),this._currentLOD===this.sourceMesh?this.sourceMesh:this._currentLOD},a.prototype._preActivateForIntermediateRendering=function(r){return this.sourceMesh._preActivateForIntermediateRendering(r)},a.prototype._syncSubMeshes=function(){if(this.releaseSubMeshes(),this._sourceMesh.subMeshes)for(var r=0;r<this._sourceMesh.subMeshes.length;r++)this._sourceMesh.subMeshes[r].clone(this,this._sourceMesh);return this},a.prototype._generatePointsArray=function(){return this._sourceMesh._generatePointsArray()},a.prototype._updateBoundingInfo=function(){var r=this;return this._boundingInfo?this._boundingInfo.update(r.worldMatrixFromCache):this._boundingInfo=new o.a(this.absolutePosition,this.absolutePosition,r.worldMatrixFromCache),this._updateSubMeshesBoundingInfo(r.worldMatrixFromCache),this},a.prototype.clone=function(r,e,t){e===void 0&&(e=null);var i=this._sourceMesh.createInstance(r);if(C.a.DeepCopy(this,i,["name","subMeshes","uniqueId","parent","lightSources","receiveShadows","material","visibility","skeleton","sourceMesh","isAnInstance","facetNb","isFacetDataEnabled","isBlocked","useBones","hasInstances","collider","edgesRenderer","forward","up","right","absolutePosition","absoluteScaling","absoluteRotationQuaternion","isWorldMatrixFrozen","nonUniformScaling","behaviors","worldMatrixFromCache","hasThinInstances"],[]),this.refreshBoundingInfo(),e&&(i.parent=e),!t)for(var u=0;u<this.getScene().meshes.length;u++){var c=this.getScene().meshes[u];c.parent===this&&c.clone(c.name,i)}return i.computeWorldMatrix(!0),i},a.prototype.dispose=function(r,e){e===void 0&&(e=!1),this._sourceMesh.removeInstance(this),f.prototype.dispose.call(this,r,e)},a}(T.a);B.a.prototype.edgesShareWithInstances=!1,B.a.prototype.registerInstancedBuffer=function(f,a){var r,e;if((e=(r=this._userInstancedBuffersStorage)===null||r===void 0?void 0:r.vertexBuffers[f])===null||e===void 0||e.dispose(),!this.instancedBuffers){this.instancedBuffers={};for(var t=0,i=this.instances;t<i.length;t++){var u=i[t];u.instancedBuffers={}}this._userInstancedBuffersStorage={data:{},vertexBuffers:{},strides:{},sizes:{},vertexArrayObjects:this.getEngine().getCaps().vertexArrayObject?{}:void 0}}this.instancedBuffers[f]=null,this._userInstancedBuffersStorage.strides[f]=a,this._userInstancedBuffersStorage.sizes[f]=a*32,this._userInstancedBuffersStorage.data[f]=new Float32Array(this._userInstancedBuffersStorage.sizes[f]),this._userInstancedBuffersStorage.vertexBuffers[f]=new n.b(this.getEngine(),this._userInstancedBuffersStorage.data[f],f,!0,!1,a,!0);for(var c=0,g=this.instances;c<g.length;c++){var u=g[c];u.instancedBuffers[f]=null}this._invalidateInstanceVertexArrayObject()},B.a.prototype._processInstancedBuffers=function(f,a){var r=f.length;for(var e in this.instancedBuffers){for(var t=this._userInstancedBuffersStorage.sizes[e],i=this._userInstancedBuffersStorage.strides[e],u=(r+1)*i;t<u;)t*=2;this._userInstancedBuffersStorage.data[e].length!=t&&(this._userInstancedBuffersStorage.data[e]=new Float32Array(t),this._userInstancedBuffersStorage.sizes[e]=t,this._userInstancedBuffersStorage.vertexBuffers[e]&&(this._userInstancedBuffersStorage.vertexBuffers[e].dispose(),this._userInstancedBuffersStorage.vertexBuffers[e]=null));var c=this._userInstancedBuffersStorage.data[e],g=0;if(a){var h=this.instancedBuffers[e];h.toArray?h.toArray(c,g):h.copyToArray(c,g),g+=i}for(var E=0;E<r;E++){var y=f[E],h=y.instancedBuffers[e];h.toArray?h.toArray(c,g):h.copyToArray(c,g),g+=i}this._userInstancedBuffersStorage.vertexBuffers[e]?this._userInstancedBuffersStorage.vertexBuffers[e].updateDirectly(c,0):(this._userInstancedBuffersStorage.vertexBuffers[e]=new n.b(this.getEngine(),this._userInstancedBuffersStorage.data[e],e,!0,!1,i,!0),this._invalidateInstanceVertexArrayObject())}},B.a.prototype._invalidateInstanceVertexArrayObject=function(){if(!(!this._userInstancedBuffersStorage||this._userInstancedBuffersStorage.vertexArrayObjects===void 0)){for(var f in this._userInstancedBuffersStorage.vertexArrayObjects)this.getEngine().releaseVertexArrayObject(this._userInstancedBuffersStorage.vertexArrayObjects[f]);this._userInstancedBuffersStorage.vertexArrayObjects={}}},B.a.prototype._disposeInstanceSpecificData=function(){for(this._instanceDataStorage.instancesBuffer&&(this._instanceDataStorage.instancesBuffer.dispose(),this._instanceDataStorage.instancesBuffer=null);this.instances.length;)this.instances[0].dispose();for(var f in this.instancedBuffers)this._userInstancedBuffersStorage.vertexBuffers[f]&&this._userInstancedBuffersStorage.vertexBuffers[f].dispose();this._invalidateInstanceVertexArrayObject(),this.instancedBuffers={}}},732:function(te,z,d){"use strict";var R=d(435),M=d(592),O=d(550),T="colorPixelShader",B=`#ifdef VERTEXCOLOR
varying vec4 vColor;
#else
uniform vec4 color;
#endif
#include<clipPlaneFragmentDeclaration>
void main(void) {
#include<clipPlaneFragment>
#ifdef VERTEXCOLOR
gl_FragColor=vColor;
#else
gl_FragColor=color;
#endif
}`;R.a.ShadersStore[T]=B;var C={name:T,shader:B}},733:function(te,z,d){"use strict";var R=d(435),M=d(487),O=d(593),T=d(501),B=d(488),C=d(489),v=d(551),n="colorVertexShader",o=`
attribute vec3 position;
#ifdef VERTEXCOLOR
attribute vec4 color;
#endif
#include<bonesDeclaration>
#include<clipPlaneVertexDeclaration>

#include<instancesDeclaration>
uniform mat4 viewProjection;
#ifdef MULTIVIEW
uniform mat4 viewProjectionR;
#endif

#ifdef VERTEXCOLOR
varying vec4 vColor;
#endif
void main(void) {
#include<instancesVertex>
#include<bonesVertex>
vec4 worldPos=finalWorld*vec4(position,1.0);
#ifdef MULTIVIEW
if (gl_ViewID_OVR == 0u) {
gl_Position=viewProjection*worldPos;
} else {
gl_Position=viewProjectionR*worldPos;
}
#else
gl_Position=viewProjection*worldPos;
#endif
#include<clipPlaneVertex>
#ifdef VERTEXCOLOR

vColor=color;
#endif
}`;R.a.ShadersStore[n]=o;var _={name:n,shader:o}}}]);
